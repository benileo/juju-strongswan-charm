restart:
  description: "Restarts the StrongSWan service"

create-root-cert:
  description: "Generate a Root CA Certificate"
  params:
    overwrite:
      type: boolean
      description: "Overwrite Existing Root CA?"
      default: false
    lifetime:
      type: string
      description: "How long is the CA valid for?"
      default: "10y"
    keysize:
      type: integer
      description: "Key Size?"
      default: 4096
      enum: [1024,2048,4096,8192]
    subject:
      type: object
      description: "Relative Distinguished Names (RDNs)"
      properties:
        cn:
          type: string
          description: "Common Name"
        dc:
          type: string
          description: "Domain Component"
        st:
          type: string
          description: "State or Province"
        l:
          type: string
          description: "Locality or Town"
        o:
          type: string
          description: "Organization"
        ou:
          type: string
          description: "Organizational Unit"
        sn:
          type: string
          description: "Serial Number"
        uid:
          type: string
          description: "User ID"
        e:
          type: string
          description: "Email Address"
      required: [cn]
  additionalProperties: false

create-host-cert:
  description: "Returns a host Certificate signed by the CA"
  params:
    lifetime:
      type: string
      description: "How long is the host certificate valid for?"
      default: "5y"
    keysize:
      type: integer
      description: "Key Size?"
      default: 2048
      enum: [1024,2048,4096,8192]
    out:
      type: string
      description: "Out format of the certificate"
      emum: [tar.gz,pkcs12,gzip]
      default: "pkcs12"
    subject:
      type: object
      description: "Relative Distinguished Names (RDNs)"
      properties:
        cn:
          type: string
          description: "Common Name"
        dc:
          type: string
          description: "Domain Component"
        st:
          type: string
          description: "State or Province"
        l:
          type: string
          description: "Locality or Town"
        o:
          type: string
          description: "Organization"
        ou:
          type: string
          description: "Organizational Unit"
        sn:
          type: string
          description: "Serial Number"
        uid:
          type: string
          description: "User ID"
        e:
          type: string
          description: "Email Address"
      required: [cn]
  additionalProperties: false   