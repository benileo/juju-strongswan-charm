#!/usr/bin/env python3
 
from charmhelpers.core import hookenv
from strongswan.openssl import create_host_cert
from strongswan.actions import action_get, action_set, action_fail

if __name__ == '__main__':
	
	params = action_get()

	if params:
		create_host_cert(
			params.get("subject"), 
			params.get("lifetime"),
			params.get("keysize"),
			params.get("out")
		)
	else:
		pass