#!/usr/bin/env python


from strongswan.apt import (
	ss_apt_pkgs
)
from strongswan.sysctl import(
	cp_sysctl_file
)
from charmhelpers.core import (
	hookenv
)
from charmhelpers.fetch import (
	apt_update,
	apt_install
)

class Strongswan():
	def __init__(self):
		self.config = hookenv.config()

	def pre_install(self):
		cp_sysctl_file() # make original copy of sysctl file
		

	def install(self):
		apt_update(fatal=False) ## TODO ## keep updating until you get something. 
		pkgs = ss_apt_pkgs(self.config) # get names of strongswan packages to install	
		apt_install(packages=pkgs,fatal=True) # install the packages 
		hookenv.log("!!!!!!!!!!!!!!!!!! - Done Install - !!!!!!!!!!!!!!!!!!!!")

	def post_install(self):
		pass

if __name__ == "__main__":
	hookenv.log("!!!!!!!!!!!!!!!!!! - Install - !!!!!!!!!!!!!!!!!!!!")
	strongswan = Strongswan()
	strongswan.pre_install()
	strongswan.install()