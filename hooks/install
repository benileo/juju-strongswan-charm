#!/usr/bin/env python3


from strongswan.apt import (
	ss_apt_pkgs,
	ss_apt_update,
	flush_hosts_file # this will be in its own file shortly......
)
from strongswan.sysctl import(
	cp_config_files
)
from strongswan.iptables import(
	iptables_configure
)
from charmhelpers.core import (
	hookenv
)
from charmhelpers.fetch import (
	apt_install
)

# global config 
config = hookenv.config()

def pre_install():
	iptables_configure(config)
	cp_config_files()
	
		
def install():
	ss_apt_update()
	pkgs = ss_apt_pkgs(config)
	apt_install(packages=pkgs,fatal=True)
	flush_hosts_file()


if __name__ == "__main__":
	hookenv.log("INFO:   Running the install hook")
	pre_install()
	install()
	hookenv.log("INFO:   Install hook has completed.")