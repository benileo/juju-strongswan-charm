#!/usr/bin/env python


from strongswan.apt import (
	ss_apt_pkgs
)
from strongswan.sysctl import(
	cp_sysctl_file
)
from charmhelpers.core import (
	hookenv
)
from charmhelpers.fetch import (
	apt_update,
	apt_install
)

# global config 
config = hookenv.config()

# make a copy of the sysctl file for reference
def pre_install():
	cp_sysctl_file()
		

def install():
	#update packages 
	apt_update(fatal=True)

	# Get lists of package to install 
	pkgs = ss_apt_pkgs(config)

	# install them
	apt_install(packages=pkgs,fatal=True) # install the packages 


if __name__ == "__main__":
	hookenv.log("INFO:   Running the install hook")
	pre_install()
	install()
	hookenv.log("INFO:   Install hook has completed.")